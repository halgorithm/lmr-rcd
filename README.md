# lmr-rcd
Kotlin package for editing La-Mulana Remake .rcd files. Compatible with Java and anything else that runs on the JVM.

Latest version: still WIP

### Getting started
1. Call `RcdParser.parse(Path rcdScriptPath)` to get a `World` tree of your .rcd file's data.
    * This method assumes that your .rcd file has an identical Zone-Scene-Screen hierarchy to the vanilla game.
        If it doesn't, you must pass a second argument `List<List<Byte>> worldScreenCounts` to indicate the number of screens within each scene within each zone.
        The [lmr-msd](https://github.com/halgorithm/lmr-msd) library's `Stage.generateSceneScreenCounts()` method can generate screen counts for each .msd.

2. Edit your world tree's actors and effects.
    * `Actor` refers to a positioned screen object and `Effect` refers to a positionless behavioral object. `Entity` is the generic term for either.
    * (Coming soon) Every entity has an associated decorator class that can wrap them with additional editing functionality e.g. `pot = Pot.wrap(myActor)`.
        These decorators allow you to edit objects in a readable, strongly-typed way and validated way, e.g. `pot.setHitSound(Sfx.SNAKE_HISS)`.
        * (Coming soon) If you find that the param validation logic for a decorator is incorrect, you can bypass it by
            simply calling `actor.getParams()` to directly access the underlying `List<Short>` params without any validations.
            However, in most cases it's be better to simply fix the validations on the decorator class to be correct.
            Decorator class files are generated by running [this task], which parses the type rules specified by
            [this rcdtype] file. The format of the file is described [here]. If you find any decorator issues, please
            submit a PR with an updated rcdtype file and re-generated class file and I'll merge them in.
    * (Coming soon) `Zone`, `Scene` and `Screen` instances all have query-building methods for efficiently fetching and filtering objects from the world.
        Queries can return decorated with `.ofType(decoratorClass: Class<Decorator>)`.
    * You can attach/detach objects at each level of the world with `addEffect(myEffect)` and `removeEffect(myEffect)`, and for screens also `addActor(myActor)` and `removeActor(myActor)`
    
3. Write your `World` back to a file using `RcdSerializer.serialize(World world, Path outputPath)`

### Documentation
More coming soon...